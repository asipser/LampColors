<html>
	<head>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
		<link rel="stylesheet" type="text/css" href="LampColors.css">
		<script src="scripts.js"></script>



	</head>

	<body>
		<canvas width ="512" height = "512" id = "gradient_canvas"> </canvas> <!-- static gradient -->
		<canvas width ="512" height = "512" id = "draw_canvas"> </canvas> <!-- drawing lines -->

		<div id = 'brightness_container'>
			<div id = 'brightness'></div>
		</div>
		

		<script type = "text/javascript">
			max_x = 512;
			max_y = 512;

			scale = 1;

			var canvas = $('#gradient_canvas')[0].getContext('2d'); // sets up canvas context allowing user interaction w/ image ([0] gives DOM object)
			var draw_canvas = $('#draw_canvas')[0].getContext('2d'); // sets up canvas context 
			draw_canvas.strokeStyle = 'rgba(0,0,0,0.2)';
			draw_canvas.lineWidth = 3;
			var img = new Image();
			img.src = 'grad.png';
			$(img).load(function(){
				canvas.drawImage(img,0,0);			
			});
			var r = 0
			var g = 0
			var b = 0

			$('#draw_canvas')[0].addEventListener('touchmove',function(e){
				draw_canvas.clearRect(0,0,max_x,max_y);
				draw_canvas.beginPath();
				var x = e.pageX - this.offsetLeft;
				var y = e.pageY - this.offsetTop;
				selectionInfo = canvas.getImageData(x,y,1,1).data;

				draw_canvas.moveTo(x,0);
				draw_canvas.lineTo(x,max_y);
				draw_canvas.stroke();
				draw_canvas.beginPath();
				draw_canvas.moveTo(0,y);
				draw_canvas.lineTo(max_x,y);
				draw_canvas.stroke();

				r = selectionInfo[0];
				g = selectionInfo[1];
				b = selectionInfo[2];
				$('#brightness').css('background-color',rgbToHex(r,g,b));
				grad_color = "#" + componentToHex(r) + componentToHex(g) + componentToHex(b);
				var css_expr = 'linear-gradient(to right, #000000 0%,' + grad_color + ' 100%)';
				console.log(css_expr);
				$('#brightness_container').css('background',css_expr);
			});

			$('#brightness_container')[0].addEventListener('touchmove',function(e){
				var x = e.pageX
						x = Math.max(45,x);
						x = Math.min(467,x);
						scale = (x-45)/467;
						color = rgbToHex(r,g,b);
						$('#brightness').css('left',x -45);
						$('#brightness').css('background-color',color);
					});






		</script>

	</body>

</html>
